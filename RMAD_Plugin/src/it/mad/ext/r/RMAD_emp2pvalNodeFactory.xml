<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE knimeNode PUBLIC "-//UNIKN//DTD KNIME Node 2.0//EN" "http://www.knime.org/Node.dtd">
<knimeNode icon="./default.png" type="Manipulator">
    <name>EPP to P-value</name>
    
    <shortDescription>
        EPP to P-value converts the Empirical Posterior Probability (EPP) computed by cluster.test into a frequentist p-value, which can then be used to assess the significance of the alternative hypothesis.
    </shortDescription>
    
    <fullDescription>
        <intro>
        The hypothesis test is formulated as a model selection problem, where the aim is to identify the model with the highest posterior probability. A Hierarchical Bayes model is assumed for the data. Note that firstly, the null hypothesis is equivalent to saying that the population consists of just one cluster. Secondly, since the functions here only allow the alternative hypothesis to be either 2, 3 or 4 at any one time, the package allows the user to test multiple hypotheses while controlling the False Discovery Rate (FDR).
        EPP to P-value converts the Empirical Posterior Probability (EPP) computed by cluster.test into a frequentist p-value, which can then be used to assess the significance of the alternative hypothesis.
		<br/> Completion may take several minutes depending on the dimensions of the dataset and how high is the number assigned to the parameters "nsim".
        <br/>
		<br/>
		More details about EPP to P-value ("emp2pval") and "bayesclust":
		<br/>
		<a href="http://cran.r-project.org/web/packages/bayesclust/bayesclust.pdf">Package "Bayesclust"</a> 
        <br/>
        <br/>
		More details about R:
		<br/>
		<a href="http://www.r-project.org/">http://www.r-project.org/</a>
		<br/>
		<a href="http://cran.r-project.org/doc/contrib/Short-refcard.pdf">Short-refcard.pdf</a>
        
        </intro>
        
        <tab name="Standard Options">
        	<option name="Filter">Filtering of data matrix or data frame. Each row must correspond to an observation, and each column must correspond to a variable. All variables must be numeric. Missing values (NAs) are allowed.</option>
        	<option name="k">k specifies the alternative hypothesis being tested. It must take an integer value strictly greater than 1.</option>
        </tab>
        
        <tab name="Advanced Options">
        	<option name="nsim (cluster.test)">As the Bayes Factor (BF) for the hypothesis is computed with the aid of a Metropolis-Hastings (MH) MCMC algorithm, the number of simulations has to be specified. It is recommended that nsim be at least 500,000, and that replications be carried out in order to monitor convergence. </option>
        	<option name="nsim (nulldensity)">This denotes the number of random variables to generate from the distribution of EPP under the null. It is recommended to be at least 100,000 when the intention is to carry out multiple testing. Otherwise 8,000-10,000 iterations will suffice. </option>
        	<option name="aR">The candidate distribution in the MH algorithm is a mixture of g and a random walk. aR, which must be a value between 0 and 1, specifies the percentage of time that the random walk is chosen. </option>
        	<option name="a">a is a hyperparameter for the prior on σ^2 . </option>
        	<option name="b">Like a, b is also a hyperparameter for the prior on σ^2 . </option>
        	<option name="tau2">tau2 is a hyperparameter for the prior on the mean μ for each cluster.</option>
        	<option name="mcs">mcs stands for Minimum Cluster Size. It should be a value between 0 and 1. It instructs the algorithm to only consider clusters of a certain minimum size.</option>
        	<option name="Replications (cluster.test)">Replications will instruct the function to perform multiple replications of the test, allowing the user to monitor convergence of the estimates of the posterior probabilities</option>
        	<option name="prop">prop specifies what fraction of the space of partitions under the null hypothesis should be sampled. It is recommended to be at least 0.25.</option>
        </tab>

    </fullDescription>
    
    <ports>
        <inPort index="0" name="Data input">Data input</inPort>
        <!-- possibly more input ports here-->
        <outPort index="0" name="Data output">R MAD Result Data</outPort>
        <!-- possibly more output ports here-->
    </ports>    
    <views>
        <view index="0" name="R MAD Std Output">The text sent to standard out during the execution of R executable as well as the text of the .Rout file generated by R.</view>
        <view index="1" name="R MAD Err Output">The text sent to standard error during the execution of R executable as well as the text of the .Rout file generated by R. (If it appears in gray, it's the output of a previously failing run which is preserved for your trouble shooting.)</view>
    </views>
</knimeNode>
